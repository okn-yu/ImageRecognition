# Charpter1 画像認識の概要

## 1.3 クラス認識の手順
* 一般的なクラス認識の手順は**画像特徴量抽出**と**分類**からなる
* 画像特徴量抽出は下のサンプリングからプーリングまでの5段階に分かれる

### 1.サンプリング
* 入力画像から多数の代表的点（キーポイント・特徴点）を選択する過程
* **粗なサンプリング**と**密なサンプリング**からなる
* 祖なサンプリングは、画像からエッジやコーナーなど特徴的な
点を検出器（アルゴリズム）を用いて抽出する
* 密なサンプリングでは、画像から一定間隔毎に代表点を抽出する
* クラス認識には密なサンプリングが多い

#### メモ
* 深層学習では一般的に入力画像をそのまま入れるので密なサンプリングが多いのでは
* 疎なサンプリングは検出器を利用するためこちらの方が複雑
* 疎なサンプリングはいわゆる**前処理**に相当
* 二値化も考えてみると疎なサンプリング

### 2.局所記述
* 代表点周辺の局所領域（画像パッチ）から特徴（局所特徴）を抽出する過程

#### メモ
* 局所領域の輝度値を並べたベクトルや輝度勾配ヒストグラムなどが相当

### 3.統計的特徴抽出
* ノイズを含む局所特徴に確率統計的な処理を施してより有効な特徴を抽出する

### メモ
* 抽出は一般に次元圧縮を伴う
* 主成分分析やフィッシャー線形判別分析などが相当
* どちらも次元圧縮手法であるが、フィッシャーの線形判別は用途が2クラス分類に限定される
* ガウスフィルタやメディアンフィルタも該当する

### 4.コーディング
* 局所特徴を認識に有効な特定次元の特徴ベクトルに変換する過程
* 代表的な手法として、複数の局所特徴の代表点を最も近い代表点に割当るベクトル量子化

### メモ
* ベクトル量子化の簡単な例は1-100までの整数の集まりを、25, 50, 75, 100のいずれかに割り当てる場合など
* jpegも内部処理にベクトル量子化を用いている模様
* https://ocw.u-tokyo.ac.jp/lecture_files/engin_01/4/notes/ja/D3-VectorQuantization.pdf

### 5.プーリング
* ある画像領域から得られた特徴ベクトル群を1本のベクトルにまとめる操作
* 画像領域全体を対処にプーリングを行うと画像1枚を代表するベクトルが得られる
* 画像の部分領域にプーリングを行うと複数の代表ベクトルが得られる
* プーリングは必ずしも画像全体を対象にしてはいないことに注意

### メモ
* 平均値プーリングが相当
* 深層学習で特徴マップを1次元のベクトルに変換する過程も該当

### 6.分類
* 画像特徴ベクトルをクラスに割り振る過程

### メモ
* 結局分類を行う場合には特徴ベクトルに最後は変換されていることに注目
* SVMや深層学習のFCが分類器に該当
* パラメトリック:母集団の分布が何らかのある分布に従っていると仮定し、その母数に対して、統計的推測を行う方法
* ノンパラメトリック:母集団に一切の分布を仮定しない場合の統計解析手法

## 1.4 深い構造と浅い構造
* （プーリングを画像全体を対象にしなければ）1.3の1-5のプロセスは繰り返しが可能
* これを利用して「画像の部分に対してクラス認識」を行い、「部分に集合として全体のクラス認識を行う」なども可能

## 1.5 物体検出
* Mask-RCNNの実装そのものである

## 1.6 インスタンス認識
* 撮影条件に依存せずに同じものを同じとして認識することがインスタンス認識
* 手順は画像の登録とクエリ画像の認識からなる
* 以下に記載されている手法は、インスタンス認識に限らずに一般的な画像処理で利用可能

### 画像の登録
#### 1. 特徴点検出と記述
* 入力画像っから局所特徴群を抽出する
* 一般に物体の回転や大きさ・明るさの変化などの影響を受けづらい幾何学的不変性をもつ局所特徴が利用される

#### 2. 画像特徴の計算とインデックス化
* 局所特徴から画像特徴を計算する
* 画像特徴には様々な量子化手法もしくはバイナリ化手法を用いる
* インデックス化には**複数の手法を混合させる**のがポイント

### クエリ画像の認識
* 1.クエリ画像のインデックス化
* 2.インデックスに対応する候補画像群の抽出
* 3.局所特徴の幾何学的一貫性の検証（局所特徴マッチングで似ている画像を選別）

## 1.7 画像認識の認識性能を向上させるための原則
* 画像認識は様々なモジュールを多段に重ねて処理が進む
* データ処理定理より前段のモジュールの改善が特に有効
